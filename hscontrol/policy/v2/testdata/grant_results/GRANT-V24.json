{
  "test_id": "GRANT-V24",
  "description": "",
  "timestamp": "2026-02-23T15:42:03Z",
  "error": true,
  "input": {
    "policy_file": "grant_policies_v2/grant_v24.json",
    "full_policy": {
      "groups": {
        "group:admins": ["kratail2tid@passkey"],
        "group:developers": ["kristoffer@dalby.cc", "kratail2tid@passkey"],
        "group:monitors": ["monitorpasskeykradalby@passkey"],
        "group:empty": []
      },
      "tagOwners": {
        "tag:server": ["kratail2tid@passkey"],
        "tag:prod": ["kratail2tid@passkey"],
        "tag:client": ["kratail2tid@passkey"],
        "tag:router": ["kratail2tid@passkey"],
        "tag:exit": ["kratail2tid@passkey"]
      },
      "hosts": {
        "webserver": "100.108.74.26",
        "prodbox": "100.103.8.15",
        "internal": "10.0.0.0/8"
      },
      "autoApprovers": {
        "routes": {
          "10.33.0.0/16": ["tag:router"],
          "0.0.0.0/0": ["tag:exit"],
          "::/0": ["tag:exit"]
        }
      },
      "grants": [
        {
          "src": ["tag:server"],
          "dst": ["autogroup:self"],
          "app": {
            "example.com/cap/self-cap": [{}]
          }
        }
      ]
    },
    "grants_section": [
      { "src": ["tag:server"], "dst": ["autogroup:self"], "app": { "example.com/cap/self-cap": [{}] } }
    ],
    "api_endpoint": "https://api.tailscale.com/api/v2/tailnet/kratail2tid%40passkey/acl",
    "api_method": "POST",
    "api_response_code": 400,
    "api_response_body": { "message": "autogroup:self can only be used with users, groups, or supported autogroups" }
  }
}
